/* ========== CSS RESET (modernized) ========== */
*,*::before,*::after{box-sizing:border-box}
*{margin:0;padding:0}
html:focus-within{scroll-behavior:smooth}
body{min-height:100vh;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased}
img,svg{display:block;max-width:100%;height:auto}
input,button,textarea,select{font:inherit}
button{cursor:pointer}
:root{--bg:#0e0f14;--bg-alt:#171a23;--bg-soft:#1f2430;--text:#e5e9f5;--text-dim:#9aa4b5;--accent:#6366f1;--accent-accent:#818cf8;--danger:#ef4444;--radius:14px;--space:clamp(.75rem,1.5vw,1.25rem);--max-w:1080px;--gradient:linear-gradient(135deg,#6366f1 0%,#8b5cf6 50%,#ec4899 100%);--shadow:0 4px 18px -4px rgba(0,0,0,.4),0 2px 4px -1px rgba(0,0,0,.3)}
.light{--bg:#f5f7fb;--bg-alt:#ffffff;--bg-soft:#eef1f5;--text:#1f2430;--text-dim:#596273;--accent:#4f46e5;--accent-accent:#6366f1;--danger:#dc2626;--shadow:0 3px 14px -4px rgba(0,0,0,.15),0 2px 4px -1px rgba(0,0,0,.08)}
body{font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:var(--bg);color:var(--text);line-height:1.55}
/* Skip link */
.skip-link{position:absolute;left:-999px;top:auto;width:1px;height:1px;overflow:hidden}
.skip-link:focus{left:50%;top:10px;width:auto;height:auto;padding:.75rem 1rem;background:var(--accent);color:#fff;z-index:999;transform:translateX(-50%);border-radius:10px;outline:none}
/* Focus ring */
:focus-visible{outline:2px solid var(--accent);outline-offset:2px}
.scroll-progress{position:absolute;inset:0 0 auto 0;height:3px;background:rgba(255,255,255,.05);}
.scroll-progress #scrollProgressBar{height:100%;width:0;background:var(--gradient);transition:width .15s linear}
.visually-hidden{position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;border:0}
.container{width:100%;max-width:var(--max-w);margin-inline:auto;padding:0 var(--space)}
.section{padding:clamp(3rem,8vh,5rem) 0;position:relative}
.section h2{font-size:clamp(1.75rem,3vw,2.4rem);margin-bottom:1rem;letter-spacing:.5px}
.section-desc{color:var(--text-dim);margin-bottom:1.5rem;max-width:720px}

/* Header */
.site-header{position:sticky;top:0;z-index:50;background:rgba(15,16,22,.72);backdrop-filter:blur(14px);border-bottom:1px solid rgba(255,255,255,.06)}
.light .site-header{background:rgba(255,255,255,.8);border-color:rgba(15,16,22,.08)}
.header-inner{display:flex;align-items:center;justify-content:space-between;gap:1.25rem;min-height:64px}
.brand{display:flex;align-items:center;gap:.75rem}
.logo-circle{background:var(--gradient);width:42px;height:42px;display:grid;place-items:center;border-radius:50%;font-size:1.25rem;box-shadow:var(--shadow)}
.main-nav ul{list-style:none;display:flex;gap:1.75rem;font-weight:500}
.main-nav a{text-decoration:none;color:var(--text-dim);position:relative;padding:.25rem .5rem;border-radius:8px;transition:.3s}
.main-nav a:hover,.main-nav a:focus,.main-nav a.active{color:var(--text);background:var(--bg-soft)}
.nav-toggle{display:none;background:var(--bg-soft);border:1px solid rgba(255,255,255,.1);color:var(--text);padding:.55rem .75rem;border-radius:10px;font-size:1.1rem;line-height:1}
.nav-toggle:hover{background:var(--accent);color:#fff;border-color:var(--accent)}
.admin-only{font-size:.9rem}
.theme-toggle{background:var(--bg-soft);border:1px solid rgba(255,255,255,.1);color:var(--text);padding:.6rem .8rem;border-radius:10px;line-height:1;display:flex;align-items:center;justify-content:center;transition:.35s}
.theme-toggle:hover{background:var(--accent);border-color:var(--accent);color:#fff}
.light .theme-toggle:hover{color:#fff}

/* Intro */
.intro-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));align-items:center;gap:3rem}
.intro-text h2{font-size:clamp(2rem,4vw,2.75rem);background:var(--gradient);-webkit-background-clip:text;background-clip:text;color:transparent}
.intro-text p{margin-bottom:1rem;max-width:560px}
.hero-art{width:100%;aspect-ratio:4/3;border-radius:var(--radius);background:
  radial-gradient(at 20% 30%,rgba(99,102,241,.5),rgba(99,102,241,0)60%),
  radial-gradient(at 80% 70%,rgba(236,72,153,.45),rgba(236,72,153,0)55%),
  linear-gradient(135deg,#1f2430,#11141b 60%);position:relative;overflow:hidden;box-shadow:0 10px 40px -10px rgba(0,0,0,.55)}
.hero-mosaic{position:absolute;inset:0;display:grid;grid-template-columns:repeat(6,1fr);grid-auto-rows:1fr;gap:4px;padding:8px;mix-blend-mode:screen;opacity:.55;filter:blur(.3px)}
.hero-mosaic span{background:#fff1;border-radius:6px;animation:fadePulse 6s ease-in-out infinite;transform-origin:center;box-shadow:0 0 0 1px #ffffff08 inset}
.hero-mosaic span:nth-child(3n){animation-delay:1s}
.hero-mosaic span:nth-child(4n){animation-delay:2.2s}
.hero-mosaic span:nth-child(5n){animation-delay:3.4s}
@keyframes fadePulse{0%,100%{opacity:.2;transform:scale(1)}50%{opacity:.85;transform:scale(1.05)}}
.hero-art:before,.hero-art:after{content:"";position:absolute;inset:0;mix-blend-mode:overlay;pointer-events:none}
.hero-art:before{background:repeating-linear-gradient(60deg,rgba(255,255,255,.05)0 2px,transparent 2px 6px)}
.hero-art:after{background:radial-gradient(circle at 30% 40%,rgba(255,255,255,.25),transparent 60%)}

/* Buttons */
.btn{display:inline-flex;align-items:center;gap:.5rem;font-weight:600;text-decoration:none;border:0;border-radius:12px;padding:.9rem 1.25rem;font-size:.95rem;line-height:1.1;transition:.35s;position:relative;isolation:isolate}
.btn.primary{background:var(--accent);color:#fff;box-shadow:0 8px 24px -10px rgba(99,102,241,.6)}
.btn.primary:hover{background:var(--accent-accent);transform:translateY(-2px)}

/* Timeline Section */
.filters{display:flex;flex-wrap:wrap;gap:1rem;margin-bottom:1.75rem;align-items:flex-end}
.filter-group{display:flex;flex-direction:column;gap:.4rem;font-size:.85rem}
.filter-group input,.filter-group select{background:var(--bg-soft);border:1px solid rgba(255,255,255,.1);color:var(--text);padding:.55rem .75rem;border-radius:10px;min-width:170px}
.light .filter-group input,.light .filter-group select{border-color:rgba(0,0,0,.08)}
.sort-group select{min-width:160px}
.timeline{list-style:none;display:grid;gap:2.5rem;position:relative;margin-left:0}
.timeline:before{content:"";position:absolute;left:20px;top:0;bottom:0;width:4px;background:linear-gradient(var(--accent),rgba(99,102,241,0));border-radius:4px}
.timeline-item{display:grid;grid-template-columns:60px 1fr;gap:1.25rem;position:relative;opacity:0;transform:translateY(30px);animation:fadeUp .7s forwards}
.timeline-item{transition:opacity .6s ease,transform .7s cubic-bezier(.33,.67,.21,1);will-change:transform,opacity}
.timeline-item.visible{opacity:1;transform:translateY(0)}
.timeline-item.timeline-group:not(.visible){transform:translateY(40px) scale(.97);opacity:0}
.timeline-item.timeline-group.visible{transform:translateY(0) scale(1);opacity:1}
.timeline-item .time{font-size:.8rem;font-weight:600;letter-spacing:.5px;color:var(--accent);padding-top:.4rem}
.timeline-item .content{background:var(--bg-soft);border:1px solid rgba(255,255,255,.07);padding:1.1rem 1.15rem;border-radius:18px;position:relative;box-shadow:var(--shadow);display:flex;flex-direction:column;gap:.65rem}
/* Giảm hiệu ứng nặng khi đang cuộn để mượt hơn */
body.scrolling .timeline-item .content{box-shadow:none}
/* Hiệu năng: trì hoãn paint/lay out khi off-screen */
.timeline-item{content-visibility:auto;contain-intrinsic-size:400px 600px}
.gallery-item{content-visibility:auto;contain-intrinsic-size:200px 260px}
.light .timeline-item .content{border-color:rgba(0,0,0,.08)}
.timeline-item:before{content:"";position:absolute;left:14px;top:18px;width:14px;height:14px;background:var(--accent);border-radius:50%;box-shadow:0 0 0 4px var(--bg)}
.timeline-item figure{margin:0}
.timeline-item .img-wrapper{border-radius:14px;overflow:hidden;/*aspect-ratio:4/3;*/background:#222;position:relative}
/* Mặc định: hiển thị toàn bộ ảnh (không crop). Muốn lại kiểu cũ đồng nhất kích thước thì dùng body.crop-tight */
.timeline-item img{width:100%;height:auto;display:block;object-fit:contain;transition:.5s transform;background:#111}
/* Chế độ cũ (crop) nếu cần: thêm class crop-tight vào body */
body.crop-tight .timeline-item .img-wrapper{aspect-ratio:4/3}
body.crop-tight .timeline-item img{height:100%;object-fit:cover}
/* Tùy chọn không giới hạn chiều cao nhưng tránh ảnh quá cao */
.timeline-item .img-wrapper{max-height:520px}
.timeline-item img:hover{transform:scale(1.06)}
.timeline-item .title{font-size:1.15rem;line-height:1.25}
.timeline-item .desc{font-size:.9rem;color:var(--text-dim)}
/* Group item */
.timeline-group .content{gap:.9rem}
.timeline-group .title small{font-weight:500;font-size:.75rem;color:var(--text-dim)}
.timeline-group .group-thumbs{display:flex;flex-wrap:wrap;gap:6px}
.timeline-group .group-thumbs .thumb{padding:0;margin:0;border:0;background:transparent;cursor:pointer;width:70px;height:70px;overflow:hidden;border-radius:10px;position:relative}
.timeline-group .group-thumbs .thumb img{width:100%;height:100%;object-fit:cover;display:block;transition:.4s transform}
.timeline-group .group-thumbs .thumb:hover img{transform:scale(1.08)}
.timeline-group .group-thumbs .more-indicator{width:70px;height:70px;display:flex;align-items:center;justify-content:center;border-radius:10px;background:var(--bg-soft);font-size:.8rem;color:var(--text-dim);border:1px dashed var(--border-soft)}
/* Nested groups */
.nested-group .subgroups{display:flex;flex-direction:column;gap:.9rem;margin-top:.25rem}
.nested-group .subgroup{border:1px solid var(--border-soft);border-radius:12px;padding:.6rem .7rem;display:flex;flex-direction:column;gap:.55rem;background:rgba(255,255,255,0.02)}
.light .nested-group .subgroup{background:rgba(0,0,0,0.03)}
/* Subgroup progressive entrance animation */
.nested-group .subgroup.pre-enter{opacity:0;transform:translateY(8px) scale(.97);filter:blur(4px)}
.nested-group .subgroup.entered{opacity:1;transform:none;filter:none;transition:opacity .55s ease,transform .55s cubic-bezier(.33,.67,.21,1),filter .6s ease}
/* will-change tạm thời khi chuẩn bị animate */
.timeline-item.pre-observe{will-change:transform,opacity}
.timeline-item.visible{will-change:auto}
.nested-group .subgroup-head{display:flex;align-items:center;justify-content:space-between;gap:.75rem}
.nested-group .subgroup-title{font-size:.9rem;margin:0;font-weight:600;display:flex;gap:.5rem;flex-wrap:wrap}
.nested-group .subgroup-title .meta{font-weight:500;color:var(--text-dim);font-size:.7rem;letter-spacing:.5px}
.nested-group .subgroup .toggle{background:var(--bg-soft);color:var(--text);border:1px solid var(--border-soft);width:28px;height:28px;border-radius:8px;cursor:pointer;font-size:1rem;line-height:1;display:flex;align-items:center;justify-content:center}
.nested-group .subgroup .toggle:hover{background:var(--accent);color:#fff}
.nested-group .subgroup-thumbs{display:flex;flex-wrap:wrap;gap:6px}
.nested-group .subgroup-thumbs .thumb{width:64px;height:64px;border:0;padding:0;border-radius:8px;overflow:hidden;cursor:pointer;background:#111}
.nested-group .subgroup-thumbs .thumb img{width:100%;height:100%;object-fit:cover;transition:.4s transform;display:block}
.nested-group .subgroup-thumbs .thumb:hover img{transform:scale(1.07)}
.nested-group .subgroup-thumbs .more-indicator{width:64px;height:64px;display:flex;align-items:center;justify-content:center;border-radius:8px;background:var(--bg-soft);font-size:.75rem;color:var(--text-dim);border:1px dashed var(--border-soft)}
.nested-group .subgroup.collapsed .subgroup-thumbs{display:none}
.nested-group .subgroup.collapsed .subgroup-title{opacity:.8}
.timeline-group .group-desc{margin:.15rem 0 .2rem;font-size:.75rem;line-height:1.25;color:var(--text-dim)}
.tags{list-style:none;display:flex;flex-wrap:wrap;gap:.5rem;margin-top:.25rem}
.tags li{font-size:.65rem;text-transform:uppercase;letter-spacing:.5px;background:rgba(255,255,255,.08);padding:.35rem .55rem;border-radius:30px;color:var(--text-dim);font-weight:600}
.light .tags li{background:rgba(0,0,0,.05)}
/* Ky navigation */
.ky-nav{margin-top:2.5rem;display:flex;flex-wrap:wrap;gap:.5rem;justify-content:center}
.ky-nav .ky-link{background:var(--bg-soft);color:var(--text-dim);border:1px solid rgba(255,255,255,.08);padding:.45rem .85rem;font-size:.65rem;font-weight:600;letter-spacing:.5px;border-radius:30px;cursor:pointer;transition:.3s}
.ky-nav .ky-link:hover{background:var(--accent);color:#fff;border-color:var(--accent)}
.ky-nav .ky-link.active{background:var(--accent);color:#fff;border-color:var(--accent);box-shadow:0 4px 16px -6px rgba(99,102,241,.65)}
.ky-badge{display:inline-block;background:linear-gradient(135deg,var(--accent),var(--accent-accent));color:#fff;padding:.25rem .65rem;border-radius:14px;font-size:.65rem;line-height:1;font-weight:600;letter-spacing:.5px;margin-right:.35rem}
/* Featured per subgroup */
.subgroup .sub-actions{display:flex;align-items:center;gap:.4rem}
.subgroup .feat-mark{background:var(--bg-soft);border:1px solid rgba(255,255,255,.12);color:#ffc94d;font-size:.75rem;line-height:1;padding:.35rem .55rem;border-radius:8px;cursor:pointer;transition:.3s}
.subgroup .feat-mark:hover{background:var(--accent);color:#fff;border-color:var(--accent)}
.subgroup .sub-feature{border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.03);padding:.55rem .65rem;border-radius:12px;display:block;width:100%}
.light .subgroup .sub-feature{background:rgba(0,0,0,.04)}
.subgroup .sub-feature figure{margin:0;display:flex;flex-direction:column;align-items:flex-start;gap:.45rem}
.subgroup .sub-feature .feat-img{width:100%;height:auto;max-height:420px;border-radius:12px;overflow:hidden;background:#111;flex:0 0 auto;box-shadow:0 10px 32px -12px rgba(0,0,0,.65)}
.subgroup .sub-feature .feat-img img{width:100%;height:100%;object-fit:contain;display:block}
.subgroup .sub-feature figcaption{font-size:.7rem;font-weight:600;color:var(--text-dim);line-height:1.35;max-width:100%}
.course-desc-full{margin:.4rem 0 .6rem;font-size:.7rem;line-height:1.45;color:var(--text-dim);background:rgba(255,255,255,.04);padding:.6rem .75rem;border:1px solid rgba(255,255,255,.06);border-radius:10px;white-space:normal}
.light .course-desc-full{background:rgba(0,0,0,.04);border-color:rgba(0,0,0,.08)}
.course-desc-full p{margin:.35rem 0 0;padding:0}
.course-desc-full p:first-child{margin-top:0}
.subgroup .thumb.is-featured{outline:2px solid var(--accent);outline-offset:0;box-shadow:0 0 0 2px rgba(99,102,241,.35);/* giữ kích thước bình thường */}
.subgroup .thumb.is-featured img{filter:brightness(1.12) saturate(1.18)}
.lightbox .lb-feature{position:absolute;top:.4rem;right:3.4rem;background:var(--bg-soft);border:1px solid rgba(255,255,255,.15);color:#ffc94d;font-size:.9rem;line-height:1;padding:.45rem .65rem;border-radius:10px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:.3s}
.lightbox .lb-feature.active{background:var(--accent);color:#fff;border-color:var(--accent)}
.lightbox .lb-feature:hover{background:var(--accent);color:#fff;border-color:var(--accent)}


/* Lightbox */
.lightbox{position:fixed;inset:0;z-index:120;display:flex;align-items:center;justify-content:center}
.lightbox.hidden{display:none}
.lightbox .lb-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.65);backdrop-filter:blur(4px)}
.lightbox .lb-dialog{position:relative;max-width:min(920px,90vw);max-height:90vh;background:var(--bg-alt);border:1px solid rgba(255,255,255,.08);padding:1rem 1.15rem;border-radius:20px;box-shadow:0 20px 60px -10px rgba(0,0,0,.6);display:flex;flex-direction:column;gap:.75rem}
.light .lightbox .lb-dialog{border-color:rgba(0,0,0,.1)}
.lightbox .lb-close{position:absolute;top:.4rem;right:.55rem;background:var(--bg-soft);border:1px solid rgba(255,255,255,.1);color:var(--text);font-size:1.1rem;line-height:1;width:34px;height:34px;border-radius:10px;display:flex;align-items:center;justify-content:center}
.lightbox .lb-close:hover{background:var(--accent);color:#fff;border-color:var(--accent)}
.lightbox figure{margin:0;display:flex;flex-direction:column;gap:.5rem}
.lightbox figure img{max-height:60vh;width:100%;object-fit:contain;border-radius:14px;background:#111}
.lightbox .lb-cap{font-size:.85rem;color:var(--text-dim)}
.lightbox .lb-meta{font-size:.7rem;letter-spacing:.5px;text-transform:uppercase;color:var(--accent);font-weight:600}
.lightbox .lb-zoom{position:absolute;top:.4rem;left:.55rem;background:var(--bg-soft);border:1px solid rgba(255,255,255,.1);color:var(--text);font-size:.8rem;line-height:1;width:34px;height:34px;border-radius:10px;display:flex;align-items:center;justify-content:center}
.lightbox .lb-zoom:hover{background:var(--accent);color:#fff}
.lightbox .lb-zoom-tools{position:absolute;top:.4rem;left:.55rem;display:flex;gap:.4rem}
.lightbox .lb-zoom-tools button{background:var(--bg-soft);border:1px solid rgba(255,255,255,.1);color:var(--text);width:34px;height:34px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:.8rem;line-height:1;transition:.3s}
.lightbox .lb-zoom-tools button:hover:not(:disabled){background:var(--accent);color:#fff}
.lightbox .lb-zoom-tools button:disabled{opacity:.35;cursor:not-allowed}
.lightbox.zoomed.zoom-original .lb-figure.panning{cursor:grabbing}
.lightbox.zoomed .lb-dialog{position:fixed;inset:0;max-width:none;width:100vw;height:100vh;display:flex;margin:0;border-radius:0;padding:clamp(.5rem,1vw,1rem);background:var(--bg-alt);}
.lightbox.zoomed figure{flex:1;display:flex;align-items:center;justify-content:center;margin:0}
.lightbox.zoomed figure img{max-width:100%;max-height:100%;width:auto;height:auto;object-fit:contain}
/* Original size mode (cycle zoom) */
.lightbox.zoomed.zoom-original .lb-dialog{cursor:grab}
.lightbox.zoomed.zoom-original figure{align-items:flex-start;justify-content:flex-start;overflow:auto}
.lightbox.zoomed.zoom-original figure img{max-width:none;max-height:none}
.lightbox .lb-scale{font-size:.6rem;color:var(--text-dim);letter-spacing:.5px}
.lightbox .lb-strip{margin-top:.25rem;max-width:100%;overflow-x:auto;padding:.4rem .2rem;background:var(--bg-soft);border:1px solid rgba(255,255,255,.05);border-radius:12px}
.lightbox .lb-strip-inner{display:flex;gap:.35rem}
.lightbox .lb-thumb{background:#0000;border:1px solid rgba(255,255,255,.15);padding:0;margin:0;width:54px;height:54px;border-radius:8px;overflow:hidden;position:relative;opacity:.55;transition:.3s}
.lightbox .lb-thumb img{width:100%;height:100%;object-fit:cover;display:block;filter:grayscale(.4);transition:.4s}
.lightbox .lb-thumb.current{border-color:var(--accent);opacity:1}
.lightbox .lb-thumb.current img{filter:none}
.lightbox .lb-thumb.future{opacity:.35}
.lightbox .lb-thumb:hover{opacity:1;border-color:var(--accent)}

/* Alternating layout on wide screens */
@media (min-width: 860px){
  .timeline{position:relative;gap:3.5rem;padding-left:0}
  .timeline:before{left:50%;transform:translateX(-50%);background:linear-gradient(to bottom,var(--accent),rgba(99,102,241,0))}
  .timeline-item{grid-template-columns:1fr;max-width:calc(50% - 3rem)}
  .timeline-item:nth-of-type(odd){justify-self:start}
  .timeline-item:nth-of-type(even){justify-self:end}
  .timeline-item:before{left:auto;top:20px;right:-41px}
  .timeline-item:nth-of-type(even):before{left:-41px;right:auto}
  .timeline-item .time{order:-1}
}

/* Year separator */
.timeline-year{position:relative;display:flex;justify-content:center;align-items:center}
.timeline-year .year-marker{background:var(--bg-soft);border:1px solid rgba(255,255,255,.12);padding:.55rem 1.1rem;border-radius:40px;font-weight:600;letter-spacing:.5px;font-size:.75rem;text-transform:uppercase;color:var(--accent);box-shadow:var(--shadow);backdrop-filter:blur(6px)}
.light .timeline-year .year-marker{border-color:rgba(0,0,0,.08)}
@media (min-width:860px){
  .timeline-year{grid-column:1/-1}
  .timeline-year .year-marker{position:relative}
}

/* Gallery */
.gallery-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:1rem;margin-top:1rem}
.gallery-item{background:var(--bg-soft);border:1px solid rgba(255,255,255,.07);border-radius:16px;overflow:hidden;position:relative;isolation:isolate;animation:fadeUp .6s both}
.light .gallery-item{border-color:rgba(0,0,0,.08)}
.gallery-item figure{margin:0}
.gallery-item .img-wrapper{aspect-ratio:1/1;overflow:hidden}
.gallery-item img{width:100%;height:100%;object-fit:cover;transition:.5s transform}
.gallery-item:hover img{transform:scale(1.08)}
.gallery-item .caption{font-size:.75rem;padding:.5rem .65rem;color:var(--text-dim)}

/* Contact */
.contact-inner{display:grid;gap:2rem;max-width:760px}
.contact-form{display:grid;gap:1.1rem}
.form-field{display:flex;flex-direction:column;gap:.45rem}
.form-field label{font-size:.8rem;font-weight:600;letter-spacing:.5px;text-transform:uppercase;color:var(--text-dim)}
.form-field input,.form-field textarea{background:var(--bg-soft);border:1px solid rgba(255,255,255,.1);color:var(--text);padding:.75rem .85rem;border-radius:12px;resize:vertical}
.light .form-field input,.light .form-field textarea{border-color:rgba(0,0,0,.08)}
.error{color:var(--danger);font-size:.7rem;min-height:1em}
.form-status{font-size:.8rem;margin-top:.25rem}

/* Footer */
.site-footer{background:var(--bg-alt);padding:2.25rem 0;margin-top:3rem;font-size:.8rem;color:var(--text-dim)}
.site-footer .container{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:1rem}
.back-to-top{background:var(--bg-soft);color:var(--text-dim);text-decoration:none;padding:.6rem .75rem;border-radius:10px;font-weight:600;font-size:.7rem;letter-spacing:.5px}
.back-to-top:hover{background:var(--accent);color:#fff}

/* Animations */
@keyframes fadeUp{to{opacity:1;transform:none}}
/* Flash focus effect for a selected Kỳ */
@keyframes kyFlash{0%{box-shadow:0 0 0 0 rgba(99,102,241,.8),0 0 0 0 rgba(236,72,153,0)}60%{box-shadow:0 0 0 6px rgba(99,102,241,0),0 0 0 12px rgba(236,72,153,0)}100%{box-shadow:0 0 0 0 rgba(99,102,241,0),0 0 0 0 rgba(236,72,153,0)}}
.timeline-item.ky-flash .content{animation:kyFlash 1.05s ease-out}

/* Image loading blur effect */
img.img-loading{filter:blur(14px) brightness(.6);transform:scale(1.03);transition:filter .5s ease,transform .6s ease}
img.img-loaded{filter:none;transform:none}
/* Skeleton shimmer placeholders shown while waiting for slow images */
.img-wrapper .skeleton, .thumb .thumb-skel{position:absolute;inset:0;border-radius:inherit;overflow:hidden}
.skeleton, .thumb-skel{background:linear-gradient(110deg,#232833 8%,#2f3642 18%,#232833 33%);background-size:200% 100%;animation:shimmer 1.15s linear infinite}
.light .skeleton, .light .thumb-skel{background:linear-gradient(110deg,#d9dce2 8%,#eceff3 18%,#d9dce2 33%)}
@keyframes shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}
.thumb{position:relative}
.thumb img{position:relative;z-index:2}
.thumb .thumb-skel{z-index:3}
.img-wrapper{position:relative}
.img-wrapper .skeleton{z-index:3}

/* Responsive tweaks */
@media (max-width:640px){
  .timeline:before{left:12px}
  .timeline-item{grid-template-columns:48px 1fr;gap:.85rem}
  .timeline-item:before{left:8px}
  .timeline-item .content{padding:.9rem .95rem}
  .main-nav{position:absolute;top:64px;left:0;right:0;background:var(--bg-alt);border-bottom:1px solid rgba(255,255,255,.08);display:none;padding:.75rem 0}
  .light .main-nav{border-color:rgba(0,0,0,.08)}
  .main-nav.open{display:block;animation:menuFade .35s ease}
  .main-nav ul{flex-direction:column;gap:.25rem;padding:0 var(--space)}
  .main-nav a{padding:.65rem .85rem;font-size:.9rem;border-radius:12px}
  .nav-toggle{display:inline-flex;align-items:center;justify-content:center}
  body.menu-open{overflow:hidden}
  .header-inner{position:relative}
}

@keyframes menuFade{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}

/* Ky nav mobile horizontal scroll improvement */
.ky-nav{scrollbar-width:thin}
@media (max-width:640px){
  .ky-nav{overflow-x:auto;-webkit-overflow-scrolling:touch;justify-content:flex-start;padding-bottom:.25rem}
  .ky-nav .ky-link{flex:0 0 auto}
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce){
  *{animation-duration:.001ms !important;animation-iteration-count:1 !important;transition:none !important;scroll-behavior:auto !important}
}

/* --- Added: Lightbox navigation buttons & subgroup description --- */
.lightbox .lb-nav-btn{position:absolute;top:50%;transform:translateY(-50%);background:rgba(0,0,0,.45);color:#fff;border:1px solid rgba(255,255,255,.15);font-size:2.2rem;line-height:1;padding:.2rem .65rem;border-radius:12px;cursor:pointer;backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center}
.lightbox .lb-nav-btn.prev{left:.55rem}
.lightbox .lb-nav-btn.next{right:.55rem}
.lightbox .lb-nav-btn:hover{background:rgba(0,0,0,.65);border-color:rgba(255,255,255,.3)}
.lightbox .lb-meta{display:flex;justify-content:center;align-items:center;gap:.85rem}
.lightbox .lb-nav-info{font-size:.65rem;color:var(--text-dim);letter-spacing:1px}
.subgroup .sub-desc{margin:.1rem 0 .2rem;font-size:.65rem;line-height:1.3;color:var(--text-dim)}
